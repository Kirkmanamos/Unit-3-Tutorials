<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Partial Fraction Decomposition</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap"
      rel="stylesheet"
    />

    <!-- KaTeX -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    ></script>

    <style>
      :root {
        /* Palette */
        --bg-color: #fafaf9; /* Stone-50 */
        --card-bg: #ffffff;
        --text-primary: #1c1917; /* Stone-900 */
        --text-secondary: #57534e; /* Stone-600 */
        --accent: #d97706; /* Amber-600 */
        --accent-light: #fcd34d;
        --primary-blue: #0f766e; /* Teal-700 */
        --border-color: #e7e5e4; /* Stone-200 */

        /* Spacing */
        --container-max-width: 800px;
        --spacing-unit: 1.5rem;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        background-color: var(--bg-color);
        color: var(--text-primary);
        font-family: "Inter", sans-serif;
        line-height: 1.6;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2rem;
        -webkit-font-smoothing: antialiased;
      }

      header {
        text-align: center;
        margin-bottom: 3rem;
        opacity: 0;
        animation: fadeIn 0.8s ease-out forwards;
      }

      h1 {
        font-family: "Playfair Display", serif;
        font-size: 3rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
        letter-spacing: -0.02em;
      }

      .subtitle {
        font-family: "Playfair Display", serif;
        font-size: 1.25rem;
        color: var(--text-secondary);
        font-style: italic;
      }

      main {
        width: 100%;
        max-width: var(--container-max-width);
        position: relative;
      }

      .card {
        background: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05),
          0 10px 15px -3px rgba(0, 0, 0, 0.05);
        padding: 3rem;
        margin-bottom: 2rem;
        border: 1px solid white;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        opacity: 0;
        transform: translateY(20px);
        animation: slideUp 0.6s ease-out 0.2s forwards;
      }

      .step-indicator {
        text-transform: uppercase;
        letter-spacing: 0.1em;
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 1rem;
        display: block;
      }

      .instruction {
        font-family: "Playfair Display", serif;
        font-size: 1.5rem;
        color: var(--text-primary);
        margin-bottom: 1.5rem;
        line-height: 1.3;
      }

      .math-display {
        font-size: 1.5rem; /* Larger math */
        padding: 2rem;
        background: var(--bg-color);
        border-radius: 8px;
        border: 1px solid var(--border-color);
        text-align: center;
        margin: 2rem 0;
        transition: all 0.3s ease;
      }

      .controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 3rem;
        border-top: 1px solid var(--border-color);
        padding-top: 2rem;
      }

      button {
        background-color: var(--text-primary);
        color: white;
        border: none;
        padding: 0.75rem 2rem;
        font-family: "Inter", sans-serif;
        font-weight: 500;
        font-size: 1rem;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      button:hover {
        background-color: var(--primary-blue);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      button.secondary {
        background-color: transparent;
        color: var(--text-secondary);
        border: 1px solid var(--border-color);
      }

      button.secondary:hover {
        background-color: var(--bg-color);
        color: var(--text-primary);
      }

      /* Progress Bar */
      .progress-container {
        width: 100%;
        height: 4px;
        background: var(--border-color);
        position: fixed;
        top: 0;
        left: 0;
        z-index: 100;
      }

      .progress-bar {
        height: 100%;
        background: var(--accent);
        width: 0%;
        transition: width 0.5s ease;
      }

      /* Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes highlight {
        0% {
          background-color: var(--bg-color);
        }
        50% {
          background-color: #fef3c7;
        } /* warm wash */
        100% {
          background-color: var(--bg-color);
        }
      }

      .animate-change {
        animation: highlight 1s ease;
      }
    </style>
  </head>
  <body>
    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <header>
      <h1>Partial Fractions</h1>
      <div class="subtitle">Decomposing Rational Expressions</div>
    </header>

    <main>
      <div class="card">
        <span class="step-indicator" id="stepLabel">The Problem</span>
        <div class="instruction" id="instructionText">
          We want to decompose this rational expression into simpler fractions.
        </div>

        <div class="math-display" id="mathContent">
          \[ \frac{9x+12}{x^2+3x+2} \]
        </div>

        <div class="controls">
          <button class="secondary" id="prevBtn" disabled>Previous</button>
          <button id="nextBtn">Factor Denominator &rarr;</button>
        </div>
      </div>
    </main>

    <script>
      const steps = [
        {
          label: "The Problem",
          instruction:
            "Start with a proper rational expression where the degree of the numerator is less than the denominator.",
          math: "\\frac{9x+12}{x^2+3x+2}",
          btnText: "Step 1: Factor Denominator",
          progress: 0,
        },
        {
          label: "Step 1: Simplify",
          instruction: "Factor the denominator completely.",
          math: "\\frac{9x+12}{(x+2)(x+1)}",
          btnText: "Step 2: Setup Decomposition",
          progress: 14,
        },
        {
          label: "Step 2: Setup",
          instruction:
            "Write the expression as the sum of two fractions with unknown constants A and B.",
          math: "\\frac{9x+12}{(x+2)(x+1)} = \\frac{A}{x+2} + \\frac{B}{x+1}",
          btnText: "Step 3: Eliminate Denominators",
          progress: 28,
        },
        {
          label: "Step 3: Eliminate Denominators",
          instruction:
            "Multiply both sides by the Least Common Denominator (LCD).",
          math: "9x+12 = A(x+1) + B(x+2)",
          btnText: "Step 4: Distribute & Group",
          progress: 42,
        },
        {
          label: "Step 4: Distribute & Group",
          instruction:
            "Distribute A and B, then group the x-terms and constant terms.",
          math: "\\begin{aligned} 9x+12 &= Ax + A + Bx + 2B \\\\ &= (A+B)x + (A+2B) \\end{aligned}",
          btnText: "Step 5: System of Equations",
          progress: 57,
        },
        {
          label: "Step 5: System of Equations",
          instruction:
            "Equate the coefficients on both sides to form a system.",
          math: "\\begin{cases} A+B = 9 \\quad \\text{(coeff of x)} \\\\ A+2B = 12 \\quad \\text{(constant)} \\end{cases}",
          btnText: "Step 6: Solve System",
          progress: 71,
        },
        {
          label: "Step 6: Solve",
          instruction:
            "Solve for A and B. (Subtracting the first eq from the second gives B=3, then A=6).",
          math: "\\begin{aligned} (A+2B) - (A+B) &= 12 - 9 \\\\ B &= 3 \\\\ \\implies A &= 6 \\end{aligned}",
          btnText: "Step 7: Final Result",
          progress: 85,
        },
        {
          label: "Step 7: Decomposition",
          instruction:
            "Substitute the values of A and B back into the original form.",
          math: "\\frac{9x+12}{x^2+3x+2} = \\frac{6}{x+2} + \\frac{3}{x+1}",
          btnText: "Restart",
          progress: 100,
        },
      ];

      let currentStep = 0;

      const mathEl = document.getElementById("mathContent");
      const instructionEl = document.getElementById("instructionText");
      const stepLabelEl = document.getElementById("stepLabel");
      const nextBtn = document.getElementById("nextBtn");
      const prevBtn = document.getElementById("prevBtn");
      const progressBar = document.getElementById("progressBar");

      function render() {
        const step = steps[currentStep];

        // Fade out math briefly to smooth transition
        mathEl.style.opacity = "0";
        instructionEl.style.opacity = "0";

        setTimeout(() => {
          // Update Content
          stepLabelEl.textContent = step.label;
          instructionEl.textContent = step.instruction;

          // Update Math
          katex.render(step.math, mathEl, {
            throwOnError: false,
            displayMode: true,
          });

          // Update Controls
          nextBtn.innerHTML =
            step.btnText +
            (currentStep < steps.length - 1 ? " &rarr;" : " &#8634;");
          prevBtn.disabled = currentStep === 0;

          // Progress
          progressBar.style.width = step.progress + "%";

          // Fade in
          mathEl.style.opacity = "1";
          instructionEl.style.opacity = "1";

          // Highlight effect
          mathEl.classList.remove("animate-change");
          void mathEl.offsetWidth; // trigger reflow
          mathEl.classList.add("animate-change");
        }, 200);
      }

      nextBtn.addEventListener("click", () => {
        if (currentStep < steps.length - 1) {
          currentStep++;
        } else {
          currentStep = 0; // Restart
        }
        render();
      });

      prevBtn.addEventListener("click", () => {
        if (currentStep > 0) {
          currentStep--;
          render();
        }
      });

      // Initial Render
      document.addEventListener("DOMContentLoaded", () => {
        render();
      });
    </script>
  </body>
</html>
